I have successfully completed my first ever simple/useful script with python.

**A little backstory:**

I have been *\*slowly\** learning python more and more over the years, and initially used it  for small projects during my physics undergrad. I only ever used it for Monte Carlo Simulations and to solve problem sets. So my experience with python is definitely beginner, I can do things with python but my overall knowledge of python is pretty limited. Anyway fast forward to this year, my wife was diagnosed with cancer so I went on Family Caregiver EI (Canadian thing) to care for her.  Than COVID happened, and my job used it as an excuse not to bring me back (bad trouble for them). Since diagnosis she has had an enormous amount of appointments to keep track off (and found it overwhelming), since I have all the time in the world I decided to dust off my fingers and get them to good use and write a script that will take her appointment information from Google Sheets and send her reminders via email of what is coming up.

Could I just remind her verbally? Probably. But this is easier, and killed some hours of the day :D

It took me a few hours, I had to do some minor reading on gspread and smtp packages. **Very basic/simple** but I wanted to share because I browse this subreddit daily and I am always reading so much helpful information. Also I am quite happy I actually made something somewhat useful. I find myself always falling into tutorial hell when it comes to learning python mainly because I can never think of something to program but this came up with my wife and I thought: "Hey, I can do this in python!"

**Anyway here is the code** *(I am always open to criticism)***:**

    import gspread
    import pandas as pd
    from datetime import datetime, timedelta
    import smtplib
    import email.message
    
    #return a DataFrame consisting of appointments that are within a certain time period
    def reminder(df, date_now, t):
        df_reminder = df.loc[((df['Date'] - date_now) < timedelta(days=t)) &
                             ((df['Date'] - date_now) >= timedelta(days=0))]
        df_days_remaining = df_reminder['Date'] - date_now #series of days remaining until appointment 
        return df_reminder, df_days_remaining
    
    
    def send_message(df, days_remaining):
        message = email.message.Message()
        message['Subject'] = f'APPOINTMENT REMINDER - {days_remaining}'
        message['From'] = 'MY EMAIL HERE'
        message.add_header('Content-Type', 'text/html')
        message.set_payload(f'''<b>You have an Appointment coming up! See the details below:</b> <br><br>
        <b>APPOINTMENT:</b> <u>{df['Appointment']}</u><br>
        <b>Doctor:</b> {df['Doctor Name']}<br>
        <b>Location:</b> {df['Location']}<br>
        <b>Date: {df['Date']} at {df['Time']}</b><br><br>
        <b>Notes:</b><br>
        <p>{df['Notes']}</p>
        ''')
        smtp_obj = smtplib.SMTP('smtp.gmail.com', 587)
        smtp_obj.ehlo()
        smtp_obj.starttls()
        smtp_obj.login('MY EMAIL HERE', 'MY PASSWORD HERE')
        smtp_obj.sendmail(message['From'], ['MY EMAIL',
                                        'WIFE EMAIL'], message.as_string()) #Send me a copy because I forget
        smtp_obj.quit()
    
    
    gs = gspread.service_account(
        filename='PATH TO JSON FILE'
    )
    
    # open sheet
    sheet = gs.open("SHEET NAME").sheet1
    date_now = datetime.today()
    
    
    # make dataframe in pandas of excel data and
    # converts date col into Datetime object
    df = pd.DataFrame(sheet.get_all_records())
    df['Date'] = pd.to_datetime(df['Date'], dayfirst=True)
    
    #return DF with appointments coming up in 7 days or less
    df, df_days_remaining = reminder(df, date_now, 7)
    for i in range(0, df.shape[0]):
        send_message(df.iloc[i], df_days_remaining.iloc[i])
    

I set it up as a windows task and she is running like a champ :P

&#x200B;

Thank you for the great community and thanks for reading!